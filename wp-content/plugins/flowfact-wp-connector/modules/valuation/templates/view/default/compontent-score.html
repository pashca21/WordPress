{# Calculation of the market range #}

{% set val_min = score.valuation.data.value - (score.valuation.data.value * 0.08) %}
{% set val_max = score.valuation.data.value + (score.valuation.data.value * 0.10) %}
{% set val_dif = (((score.valuation.growth.end.value - score.valuation.growth.start.value) * 100) / score.valuation.growth.start.value)|round(2, 'floor') %}

{% set rent_min = score.rent.data.value - (score.rent.data.value * 0.04) %}
{% set rent_max = score.rent.data.value + (score.rent.data.value * 0.04) %}
{% set rent_dif = (((score.rent.growth.end.value - score.rent.growth.start.value) * 100) / score.rent.growth.start.value)|round(2, 'floor') %}





<div class="FFvaluation-default-score">
	<div class="FFvaluation-default-facts">
		<div>
			<div>
				<h2>Verkaufen</h2>
				<div class="FFvaluation-default-score-value">{{val_min|number_format(0, ',', '.')}}€ <b>bis</b> {{val_max|number_format(0, ',', '.')}}€<small>*</small></div>
				<div>Möglicher Verkaufspreis</div>
				
				<div class="FFvaluation-default-score-value">{{(val_min/search.search.livingarea)|number_format(0, ',', '.')}}€ <b>bis</b> {{(val_max / search.search.livingarea)|number_format(0, ',', '.')}}€<small>*</small></div>
				<div>Möglicher Verkaufspreis pro m²</div>

				<div class="FFvaluation-default-score-value  estimation">
				
					{% if val_dif >= 0 %}
						<div class="FFvaluation-top">
							<span>{{ val_dif }}%<small>*</small></span>
							<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
						</div>
					{% elseif val_dif == 0 %}
						<div class="FFvaluation-none">
							<span>{{ val_dif }}%<small>*</small></span>
							<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
						</div>
					{% else %}
						<div class="FFvaluation-flop">
							<span>{{ val_dif }}%<small>*</small></span>
							<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
						</div>
					{% endif %}	
				
				</div>
				<div>Preisentwicklung der letzten 12 Monate</div>
				
				<br/>
				<br/>
				<b class="FFvaluation-subtitle">Regionale Preisentwicklung</b>
				<canvas id="ChartA" width="100%" class="FFvaluation-default-score-chart"></canvas>
			</div>
		</div>
		
		<div>
				<div>
					<h2>Vermieten</h2>
					<div  class="FFvaluation-default-score-value">{{rent_min |number_format(0, ',', '.')}}€ <b>bis</b> {{rent_max|number_format(0, ',', '.')}}€<small>*</small></div>
					<div>Mögliche monatliche Kaltmiete</div>
					
					<div  class="FFvaluation-default-score-value">{{(rent_min / search.search.livingarea)|round(2, 'floor')}}€ <b>bis</b> {{(rent_max / search.search.livingarea)|round(2, 'floor')}}€<small>*</small></div>
					<div>Mögliche monatliche Kaltmiete pro m²</div>
					
					<div  class="FFvaluation-default-score-value estimation">
						
						
						{% if rent_dif >= 0 %}
							<div class="FFvaluation-top">
								<span>{{ rent_dif }}%<small>*</small></span>
								<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
							</div>
						{% elseif rent_dif == 0 %}
							<div class="FFvaluation-none">
								<span>{{ rent_dif }}%<small>*</small></span>
								<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
							</div>
						{% else %}
							<div class="FFvaluation-flop">
								<span>{{ rent_dif }}%<small>*</small></span>
								<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="40px" height="40px" viewBox="0 0 408 408" style="enable-background:new 0 0 408 408;" xml:space="preserve"><g>	<g id="arrow-back">		<path class="FFvaluation-svg" d="M408,178.5H96.9L239.7,35.7L204,0L0,204l204,204l35.7-35.7L96.9,229.5H408V178.5z"/>	</g></g></svg>
							</div>
						{% endif %}
						
					</div>
					<div>Mietpreisentwicklung der letzten 12 Monate</div>
					
					<br/>
					<br/>
					<b class="FFvaluation-subtitle">Regionale Mietpreisentwicklung</b>
					<canvas id="ChartB" width="100%" class="FFvaluation-default-score-chart"></canvas>
				</div>
		
		</div>
		
		{% if legal.reply %}
			<div>		
				<div class="ff-facts-overlay" style="background-image:url({{path}}/marktwert.jpg);">
					<div>
						<button style="width: 70%; margin: auto;" class="FFvaluation-default-popup-open">Jetzt kostenlose Marktwertermittlung anfordern</button>
					</div>
				</div>
			</div>
		{% endif %}
	</div>

	<div>
		{# Legal information #}
			
			<div class="FFvaluation-default-scoring-legal">
				<small>*</small> Sämtliche Berechnungen erfolgten anhand Ihrer getätigten Angaben:
				<span><b>Lage:</b> {{search.search.street}} {{search.search.street_number}}, {{search.search.zip}} {{search.search.town}}  </span>

				{% for rowkey, row in search.search %}
					{% for mappingkey, mappingrow in mapping.search.default %}
					
						{% if mappingkey == rowkey %}
							{% if mappingrow.type == "option" %}
								<span><b>{{ mappingrow.caption}}:</b>&nbsp; 
									{% for optkey,option in mappingrow.option %}
										{% if optkey == row %}
											{{option}}
										{% endif%}
									{% endfor%}

									{{ mappingrow.unit}}  
								</span>&nbsp;
							{% else%}
								<span><b>{{ mappingrow.caption}}:</b> {{ row }} {{ mappingrow.unit}}</span>&nbsp;	
							{% endif%}
						{% endif%}

					{% endfor %}
				{% endfor %}
				. Die Berechnungen basieren auf den Marktdaten der Firma Sprengnetter. Sie spiegeln den Marktdurchschnitt wider und dienen zur keiner Zeit als Kauf- oder Verkaufsempfehlung. Auch stellt sie keinerlei verbindliche Preisempfehlung dar.
			</div>

	</div>
</div>




	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
	<script>
		var ctx1 = document.getElementById("ChartA").getContext('2d');
		var ctx2 = document.getElementById("ChartB").getContext('2d');
		
		
		var gradientFill = ctx1.createLinearGradient(0, 0, 0,  170);
		gradientFill.addColorStop(0, "{{color.primary}}");
		gradientFill.addColorStop(1, "rgba(255, 255, 255, 0.1)");
		
		var gradientFill = ctx2.createLinearGradient(0, 0, 0,  170);
		gradientFill.addColorStop(0, "{{color.primary}}");
		gradientFill.addColorStop(1, "rgba(255, 255, 255, 0.1)");
		
		
		var myChart1 = new Chart(ctx1, {
			type: 'line',
			data: {
				labels: [{% for field in score.valuation.growth.data %}"(Stand 1.{{field.month}}.{{field.year}})",{% endfor%}],
				datasets: [{
					label: 'Durchschnittlicher Preis in € pro m² in der Region',
					borderColor: "{{color.primary}}",
					pointBorderColor: "{{color.primary}}",
					pointBackgroundColor: "#fff",
					pointBorderWidth: 3,
					pointHoverRadius: 5,
					pointRadius: 3,
					borderWidth:3,
					backgroundColor: gradientFill,
					fill: true,
					data: [{% for field in score.valuation.growth.data %}"{{field.value}}",{% endfor%}]
				}]
			},
			options: {
				responsive: true,
				legend: {
					display: false
				},
				
				scales: {
					xAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						gridLines: {
							display:false
						}
					}],
					yAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						gridLines: {
							display:false
						}
						
					}]
				}
			}
		});	
		
		var myChart2 = new Chart(ctx2, {
			type: 'line',
			data: {
				labels: [{% for field in score.rent.growth.data %}"(Stand 1.{{field.month}}.{{field.year}})",{% endfor%}],
				datasets: [{
					label: 'Durchschnittlicher Preis in € pro m² in der Region',
					borderColor: "{{color.primary}}",
					pointBorderColor: "{{color.primary}}",
					pointBackgroundColor: "#fff",
					pointBorderWidth: 3,
					pointHoverRadius: 5,
					pointRadius: 3,
					borderWidth: 3,
					backgroundColor: gradientFill,
					fill: true,
					data: [{% for field in score.rent.growth.data %}"{{field.value}}",{% endfor%}]
				}]
			},
			options: {
				responsive: true,
				legend: {
					display: false
				},
				
				scales: {
					xAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						gridLines: {
							display:false
						}
					}],
					yAxes: [{
						display: false,
						scaleLabel: {
							display: false,
							labelString: ''
						},
						gridLines: {
							display:false
						}
						
					}]
				}
			}
		});	
	</script>
	
	
	{% include 'compontent-contact.html' %}
	
	
	
	
	
	
	
